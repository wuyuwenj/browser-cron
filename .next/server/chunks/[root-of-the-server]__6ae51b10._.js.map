{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 3, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 61, "column": 0}, "map": {"version":3,"sources":["file:///Users/wuyuwenjames/Desktop/cs/browser-automation-platform/src/lib/db.ts"],"sourcesContent":["import { PrismaClient } from '@prisma/client';\n\nconst globalForPrisma = globalThis as unknown as {\n  prisma: PrismaClient | undefined;\n};\n\nexport const db = globalForPrisma.prisma ?? new PrismaClient();\n\nif (process.env.NODE_ENV !== 'production') globalForPrisma.prisma = db;\n"],"names":[],"mappings":";;;;AAAA;;AAEA,MAAM,kBAAkB;AAIjB,MAAM,KAAK,gBAAgB,MAAM,IAAI,IAAI,6IAAY;AAE5D,wCAA2C,gBAAgB,MAAM,GAAG","debugId":null}},
    {"offset": {"line": 86, "column": 0}, "map": {"version":3,"sources":["file:///Users/wuyuwenjames/Desktop/cs/browser-automation-platform/src/lib/cronUtils.ts"],"sourcesContent":["import parser from \"cron-parser\";\n\n/**\n * Check if a cron schedule is due to run now\n * @param cronExpression Cron expression (e.g., \"0 9 * * MON\")\n * @param now Current date/time\n * @param withinMinutes How many minutes to look ahead (default: 5)\n * @returns True if the task should run now\n */\nexport function isDueNow(\n  cronExpression: string,\n  now: Date = new Date(),\n  withinMinutes: number = 5\n): boolean {\n  try {\n    const interval = parser.parseExpression(cronExpression, {\n      currentDate: new Date(now.getTime() - withinMinutes * 60 * 1000),\n    });\n\n    const nextRun = interval.next().toDate();\n    const timeDiff = Math.abs(nextRun.getTime() - now.getTime());\n\n    // If next run is within withinMinutes, consider it due\n    return timeDiff <= withinMinutes * 60 * 1000;\n  } catch (error) {\n    console.error(\"Invalid cron expression:\", cronExpression, error);\n    return false;\n  }\n}\n\n/**\n * Get the next run time for a cron expression\n * @param cronExpression Cron expression\n * @returns Next run date or null if invalid\n */\nexport function getNextRunTime(cronExpression: string): Date | null {\n  try {\n    const interval = parser.parseExpression(cronExpression);\n    return interval.next().toDate();\n  } catch (error) {\n    console.error(\"Invalid cron expression:\", cronExpression, error);\n    return null;\n  }\n}\n\n/**\n * Validate a cron expression\n * @param cronExpression Cron expression to validate\n * @returns True if valid\n */\nexport function isValidCron(cronExpression: string): boolean {\n  try {\n    parser.parseExpression(cronExpression);\n    return true;\n  } catch (error) {\n    return false;\n  }\n}\n"],"names":[],"mappings":";;;;;;;;AAAA;;AASO,SAAS,SACd,cAAsB,EACtB,MAAY,IAAI,MAAM,EACtB,gBAAwB,CAAC;IAEzB,IAAI;QACF,MAAM,WAAW,4JAAM,CAAC,eAAe,CAAC,gBAAgB;YACtD,aAAa,IAAI,KAAK,IAAI,OAAO,KAAK,gBAAgB,KAAK;QAC7D;QAEA,MAAM,UAAU,SAAS,IAAI,GAAG,MAAM;QACtC,MAAM,WAAW,KAAK,GAAG,CAAC,QAAQ,OAAO,KAAK,IAAI,OAAO;QAEzD,uDAAuD;QACvD,OAAO,YAAY,gBAAgB,KAAK;IAC1C,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,4BAA4B,gBAAgB;QAC1D,OAAO;IACT;AACF;AAOO,SAAS,eAAe,cAAsB;IACnD,IAAI;QACF,MAAM,WAAW,4JAAM,CAAC,eAAe,CAAC;QACxC,OAAO,SAAS,IAAI,GAAG,MAAM;IAC/B,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,4BAA4B,gBAAgB;QAC1D,OAAO;IACT;AACF;AAOO,SAAS,YAAY,cAAsB;IAChD,IAAI;QACF,4JAAM,CAAC,eAAe,CAAC;QACvB,OAAO;IACT,EAAE,OAAO,OAAO;QACd,OAAO;IACT;AACF","debugId":null}},
    {"offset": {"line": 131, "column": 0}, "map": {"version":3,"sources":["file:///Users/wuyuwenjames/Desktop/cs/browser-automation-platform/src/app/api/tasks/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from \"next/server\";\nimport { db } from \"@/lib/db\";\nimport { z } from \"zod\";\nimport { isValidCron } from \"@/lib/cronUtils\";\n\nconst createTaskSchema = z.object({\n  userId: z.string(),\n  name: z.string().min(1),\n  description: z.string().min(1),\n  targetSite: z.string(),\n  cronSchedule: z.string().optional(),\n  isActive: z.boolean().optional().default(true),\n});\n\n// GET /api/tasks - List all tasks (with optional userId filter)\nexport async function GET(request: NextRequest) {\n  try {\n    const searchParams = request.nextUrl.searchParams;\n    const userId = searchParams.get(\"userId\");\n\n    const tasks = await db.task.findMany({\n      where: userId ? { userId } : undefined,\n      include: {\n        runs: {\n          orderBy: { startedAt: \"desc\" },\n          take: 5, // Last 5 runs\n        },\n      },\n      orderBy: { createdAt: \"desc\" },\n    });\n\n    return NextResponse.json({ tasks });\n  } catch (error: any) {\n    return NextResponse.json(\n      { error: error?.message ?? \"Failed to fetch tasks\" },\n      { status: 500 }\n    );\n  }\n}\n\n// POST /api/tasks - Create a new task\nexport async function POST(request: NextRequest) {\n  try {\n    const body = await request.json();\n    const validatedData = createTaskSchema.parse(body);\n\n    // Validate cron expression if provided\n    if (validatedData.cronSchedule && !isValidCron(validatedData.cronSchedule)) {\n      return NextResponse.json(\n        { error: \"Invalid cron expression\" },\n        { status: 400 }\n      );\n    }\n\n    const task = await db.task.create({\n      data: validatedData,\n    });\n\n    return NextResponse.json({ task }, { status: 201 });\n  } catch (error: any) {\n    if (error instanceof z.ZodError) {\n      return NextResponse.json(\n        { error: \"Validation failed\", details: error.errors },\n        { status: 400 }\n      );\n    }\n\n    return NextResponse.json(\n      { error: error?.message ?? \"Failed to create task\" },\n      { status: 500 }\n    );\n  }\n}\n"],"names":[],"mappings":";;;;;;AAAA;AACA;AACA;AACA;;;;;AAEA,MAAM,mBAAmB,oLAAC,CAAC,MAAM,CAAC;IAChC,QAAQ,oLAAC,CAAC,MAAM;IAChB,MAAM,oLAAC,CAAC,MAAM,GAAG,GAAG,CAAC;IACrB,aAAa,oLAAC,CAAC,MAAM,GAAG,GAAG,CAAC;IAC5B,YAAY,oLAAC,CAAC,MAAM;IACpB,cAAc,oLAAC,CAAC,MAAM,GAAG,QAAQ;IACjC,UAAU,oLAAC,CAAC,OAAO,GAAG,QAAQ,GAAG,OAAO,CAAC;AAC3C;AAGO,eAAe,IAAI,OAAoB;IAC5C,IAAI;QACF,MAAM,eAAe,QAAQ,OAAO,CAAC,YAAY;QACjD,MAAM,SAAS,aAAa,GAAG,CAAC;QAEhC,MAAM,QAAQ,MAAM,wHAAE,CAAC,IAAI,CAAC,QAAQ,CAAC;YACnC,OAAO,SAAS;gBAAE;YAAO,IAAI;YAC7B,SAAS;gBACP,MAAM;oBACJ,SAAS;wBAAE,WAAW;oBAAO;oBAC7B,MAAM;gBACR;YACF;YACA,SAAS;gBAAE,WAAW;YAAO;QAC/B;QAEA,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE;QAAM;IACnC,EAAE,OAAO,OAAY;QACnB,OAAO,gJAAY,CAAC,IAAI,CACtB;YAAE,OAAO,OAAO,WAAW;QAAwB,GACnD;YAAE,QAAQ;QAAI;IAElB;AACF;AAGO,eAAe,KAAK,OAAoB;IAC7C,IAAI;QACF,MAAM,OAAO,MAAM,QAAQ,IAAI;QAC/B,MAAM,gBAAgB,iBAAiB,KAAK,CAAC;QAE7C,uCAAuC;QACvC,IAAI,cAAc,YAAY,IAAI,CAAC,IAAA,wIAAW,EAAC,cAAc,YAAY,GAAG;YAC1E,OAAO,gJAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;YAA0B,GACnC;gBAAE,QAAQ;YAAI;QAElB;QAEA,MAAM,OAAO,MAAM,wHAAE,CAAC,IAAI,CAAC,MAAM,CAAC;YAChC,MAAM;QACR;QAEA,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE;QAAK,GAAG;YAAE,QAAQ;QAAI;IACnD,EAAE,OAAO,OAAY;QACnB,IAAI,iBAAiB,oLAAC,CAAC,QAAQ,EAAE;YAC/B,OAAO,gJAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;gBAAqB,SAAS,MAAM,MAAM;YAAC,GACpD;gBAAE,QAAQ;YAAI;QAElB;QAEA,OAAO,gJAAY,CAAC,IAAI,CACtB;YAAE,OAAO,OAAO,WAAW;QAAwB,GACnD;YAAE,QAAQ;QAAI;IAElB;AACF","debugId":null}}]
}